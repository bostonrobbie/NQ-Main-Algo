// This Pine Script was auto-generated by the StrategyPipeline System
// Strategy: NqOrb15m
// Params: {'sl_atr_mult': 3.0, 'tp_atr_mult': 3.0}
//@version=5
strategy('NqOrb15m (Auto)', overlay=true, initial_capital=100000, default_qty_type=strategy.fixed, default_qty_value=1)


// --- ORB Visuals ---
orb_start_time = input.session("0930-0945", "ORB Range")
orb_session = time(timeframe.period, orb_start_time)

var float orb_high = na
var float orb_low = na
var box orb_box = na

// Reset daily
if ta.change(time("D"))
    orb_high := na
    orb_low := na

// Capture Range
if not na(orb_session)
    if na(orb_high)
        orb_high := high
        orb_low := low
    else
        orb_high := math.max(orb_high, high)
        orb_low := math.min(orb_low, low)

// Draw Box at end of range
if na(orb_session) and not na(orb_session[1])
    // Session just ended
    orb_box := box.new(left=bar_index[15], top=orb_high, right=bar_index + 30, bottom=orb_low, border_color=color.blue, border_style=line.style_solid, bgcolor=color.new(color.blue, 90))
    
    // Extend box to end of day? Visual preference. 
    // Here we just draw simple lines for the levels
    line.new(bar_index, orb_high, bar_index + 100, orb_high, color=color.green, style=line.style_dashed)
    line.new(bar_index, orb_low, bar_index + 100, orb_low, color=color.red, style=line.style_dashed)

plot(orb_high, "ORB High", color=color.green, style=plot.style_linebr)
plot(orb_low, "ORB Low", color=color.red, style=plot.style_linebr)
